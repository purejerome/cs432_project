// A05_spills_many_locals_and_calls.decaf
// Many locals, calls, and live values to stress spilling and call preservation.

def int inc(int x)
{
    int r;
    r = x + 1;
    return r;
}

def int pair_sum(int x, int y)
{
    int r;
    r = x + y;
    return r;
}

def int main()
{
    int a;
    int b;
    int c;
    int d;
    int e;
    int f;
    int g;
    int h;
    int i;
    int j;
    int k;
    int result;

    a = 1;
    b = 2;
    c = 3;
    d = 4;
    e = 5;
    f = 6;
    g = 7;
    h = 8;
    i = 9;
    j = 10;
    k = 11;

    // Several calls, with many values still live.
    result = pair_sum(inc(a + b), inc(c + d))
           + pair_sum(inc(e + f), inc(g + h))
           + pair_sum(inc(i + j), inc(k));

    // Compute expected: (1+2)=3->4, (3+4)=7->8 => 12
    // (5+6)=11->12, (7+8)=15->16 => 28
    // (9+10)=19->20, (11)->12 => 32
    // total = 12 + 28 + 32 = 72

    print_int(result);
    print_str("\n");

    return result;
}
